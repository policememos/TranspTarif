всё без рефактора, осторожно говнокод
